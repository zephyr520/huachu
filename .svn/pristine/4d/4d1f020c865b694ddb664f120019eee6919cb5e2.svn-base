package com.huachu.common.util;

import java.util.Date;
import java.util.regex.Pattern;


import com.huachu.common.constants.ClientType;

public class TokenUtil {
	
	private static final String SEC_KEY = "@^_^123aBcZ*";
	private static final String ACCESS_TOKEN_KEY_PREFIX = "AT";
	private static final String REFRESH_TOKEN_KEY_PREFIX = "RT";

	private static final Pattern PTN = Pattern.compile("^([\\d]+)[\\|]([a-zA-Z]+)[\\|]([\\d]+)$");
	
	public static String createAccessToken(Integer userid, ClientType role) {
		return createToken(userid, role, ACCESS_TOKEN_KEY_PREFIX+SEC_KEY);
	}
	
	public static String createRefreshToken(Integer userid, ClientType role) {
		return createToken(userid, role, REFRESH_TOKEN_KEY_PREFIX+SEC_KEY);
	}
	
	private static String createToken(Integer userid, ClientType role, String key) {
		StringBuilder content = new StringBuilder();
		content.append(userid).append("|");
		content.append(role.name()).append("|");
		content.append(new Date().getTime());
		return AESUtil.encryptString(content.toString(), key);
	}
}
